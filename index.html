<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistente FF ‚Äì M√≥dulo de Otimiza√ß√£o V4.1 ‚Äì Edi√ß√£o Avan√ßada</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================================= */
        /* VARI√ÅVEIS DE COR E ESTILO - TEMA CYBERPUNK AVAN√áADO     */
        /* ========================================================= */
        :root {
            --neon-primary: #a100ff; /* Roxo Profundo */
            --neon-secondary: #00eaff; /* Ciano Vibrante */
            --bg-dark: #07061d; /* Fundo Ultra Escuro */
            --bg-card: rgba(10, 5, 20, 0.95); /* Fundo do Card Mais Opaco */
            --bg-inactive: #1f1e33;
            --shadow-primary: 0 0 35px rgba(161, 0, 255, 0.7), inset 0 0 10px rgba(161, 0, 255, 0.2);
            --shadow-secondary: 0 0 35px rgba(0, 234, 255, 0.7), inset 0 0 10px rgba(0, 234, 255, 0.2);
            --border-glow: 1px solid var(--neon-primary);
            --accent-glow-cyan: 0 0 15px var(--neon-secondary), 0 0 30px var(--neon-secondary);
            --accent-glow-purple: 0 0 15px var(--neon-primary), 0 0 30px var(--neon-primary);
        }

        /* ========================================================= */
        /* ESTILOS GERAIS E FUNDO */
        /* ========================================================= */
        .futuristic-theme { 
            background-color: var(--bg-dark); 
            color: #e0f7fa; 
            font-family: 'Inter', sans-serif; 
            position: relative; 
            min-height: 100vh;
            overflow-x: hidden; /* Evita scroll horizontal em alguns efeitos */
        }

        /* Fundo de V√≠deo e Efeito de Matriz */
        #video-background { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; 
            z-index: 0; opacity: 0.2; pointer-events: none; filter: brightness(0.6) blur(3px) grayscale(50%); 
            transition: opacity 1s ease-in-out; /* Suaviza a entrada do fundo */
        }
        #video-background iframe { 
            width: 100vw; height: 56.25vw; min-height: 100vh; min-width: 177.77vh; 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
        }

        /* Efeito de Scanline/Matrix (simula√ß√£o de c√≥digo no fundo) */
        .matrix-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 1;
            background-image: repeating-linear-gradient(
                to bottom,
                rgba(0, 0, 0, 0.08), /* Linhas um pouco mais vis√≠veis */
                rgba(0, 0, 0, 0.6) 1px,
                transparent 1px,
                transparent 2px
            ),
            linear-gradient(
                to bottom, 
                rgba(7, 6, 29, 0.4), /* Gradiente mais sutil no topo */
                rgba(7, 6, 29, 1) 70% /* Escurece mais r√°pido para o fundo s√≥lido */
            );
            pointer-events: none;
            animation: matrix-scroll 60s linear infinite; /* Anima√ß√£o de rolagem lenta */
        }

        @keyframes matrix-scroll {
            from { background-position: 0 0; }
            to { background-position: 0 100%; }
        }

        /* Efeito de glitch no t√≠tulo principal */
        .glitch-text {
            animation: glitch-anim 2s infinite alternate linear;
        }

        @keyframes glitch-anim {
            0% { text-shadow: none; }
            20% { text-shadow: var(--accent-glow-cyan); transform: skew(-5deg); }
            40% { text-shadow: var(--accent-glow-purple); transform: skew(3deg); }
            60% { text-shadow: var(--accent-glow-cyan); transform: skew(-2deg); }
            80% { text-shadow: var(--accent-glow-purple); transform: skew(1deg); }
            100% { text-shadow: none; }
        }

        /* ========================================================= */
        /* ESTILOS DO NOVO PAINEL CENTRAL (Assistente FF) */
        /* ========================================================= */
        .main-panel-container {
            position: relative;
            z-index: 10;
            padding-top: 5rem;
            padding-bottom: 5rem;
            display: flex;
            justify-content: center;
        }

        .hud-frame {
            width: 100%;
            max-width: 950px; /* Pouco mais largo */
            padding: 3rem; /* Mais preenchimento */
            background-color: var(--bg-card);
            backdrop-filter: blur(15px) saturate(150%); /* Blur mais intenso */
            border: 2px solid rgba(161, 0, 255, 0.6); /* Borda mais definida */
            border-radius: 25px; /* Bordas mais suaves */
            box-shadow: var(--shadow-primary);
            position: relative;
            animation: boot-up 1s ease-out forwards; /* Anima√ß√£o mais longa */
            overflow: hidden; /* Para garantir que o pseudo-elemento da borda n√£o vaze */
        }

        /* Anima√ß√£o de entrada do painel */
        @keyframes boot-up {
            from { opacity: 0; transform: translateY(80px) scale(0.9); filter: blur(10px); }
            to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
        }

        /* Efeito de Borda Neon Animada (mais complexo) */
        .hud-frame::before {
            content: '';
            position: absolute;
            top: -10px; bottom: -10px; left: -10px; right: -10px; /* Borda mais espessa */
            border-radius: 30px; /* Acompanha o raio do pai */
            background: linear-gradient(45deg, #ff00ff, var(--neon-primary), var(--neon-secondary), #00ffff, var(--neon-primary)); /* Gradiente mais rico */
            background-size: 600% 600%; /* Mais √°reas para animar */
            z-index: -1;
            opacity: 0.9;
            filter: blur(20px); /* Blur mais intenso para o brilho */
            animation: border-glow-animate 10s ease-in-out infinite alternate,
                       hue-rotate 20s linear infinite; /* Anima√ß√£o de cor e rota√ß√£o de hue */
        }

        @keyframes border-glow-animate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes hue-rotate {
            from { filter: blur(20px) hue-rotate(0deg); }
            to { filter: blur(20px) hue-rotate(360deg); }
        }

        .neon-title {
            font-family: 'Orbitron', sans-serif; /* Fonte mais futurista */
            text-shadow: var(--accent-glow-purple), var(--accent-glow-cyan); /* Combina os brilhos */
        }

        /* Estilo para as caixas de fun√ß√£o e diagn√≥stico - com efeito hover */
        .module-box {
            padding: 1.8rem; /* Mais preenchimento */
            background-color: rgba(30, 30, 50, 0.8); /* Fundo mais escuro */
            border-radius: 15px; /* Bordas mais suaves */
            border-left: 6px solid var(--neon-primary); /* Borda mais grossa */
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.6), inset 0 0 5px rgba(255, 255, 255, 0.05); /* Sombra mais profunda */
            transition: all 0.3s ease-in-out;
        }
        .module-box:hover {
            transform: translateY(-5px) scale(1.01);
            border-left-color: var(--neon-secondary); /* Muda a cor da borda ao hover */
            box-shadow: var(--shadow-secondary); /* Brilho secund√°rio ao hover */
        }
        
        /* Estilos dos Toggles Modernos (mais avan√ßado) */
        .modern-switch {
            width: 70px; height: 35px; /* Maior */
            background-color: var(--bg-inactive); 
            border-radius: 9999px; position: relative; cursor: pointer; 
            transition: background-color 0.4s, box-shadow 0.4s, border-color 0.4s; 
            border: 3px solid rgba(161, 0, 255, 0.3); /* Borda sutil */
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.4);
        }
        .modern-switch:before {
            content: ''; position: absolute; top: 4px; left: 4px; /* Ajuste de posi√ß√£o */
            width: 25px; height: 25px; background-color: #e0f7fa; 
            border-radius: 50%; transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1.2), background-color 0.4s, box-shadow 0.4s; /* Anima√ß√£o mais suave e el√°stica */
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.6);
        }
        .modern-switch.active {
            background: linear-gradient(90deg, var(--neon-primary) 0%, var(--neon-secondary) 100%); /* Gradiente vibrante */
            box-shadow: var(--shadow-secondary); /* Brilho intenso */
            border-color: var(--neon-secondary);
        }
        .modern-switch.active:before {
            transform: translateX(35px); /* Deslocamento maior */
            background-color: #fff; /* Bolinha branca */
            box-shadow: var(--accent-glow-primary); /* Brilho na bolinha */
        }
        .modern-switch:active:before { /* Efeito de click pressionado */
            width: 30px; 
            box-shadow: 0 0 15px var(--neon-secondary);
        }

        /* Estilos para a parte de Conex√£o/Ping */
        .ping-display {
            font-size: 3.5rem; /* Maior */
            font-weight: bold;
            color: var(--neon-secondary);
            text-shadow: var(--accent-glow-cyan); /* Brilho do ciano */
            font-family: 'Share Tech Mono', monospace; /* Fonte tech */
            animation: text-flicker 1.5s infinite alternate; /* Efeito de flicker sutil */
        }

        @keyframes text-flicker {
            0%, 100% { opacity: 1; text-shadow: var(--accent-glow-cyan); }
            50% { opacity: 0.8; text-shadow: none; }
        }

        .status-secure {
            color: #00ff99;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(0, 255, 153, 0.8);
            font-family: 'Share Tech Mono', monospace;
            animation: secure-pulse 2s infinite alternate;
        }
        @keyframes secure-pulse {
            0% { opacity: 0.8; }
            100% { opacity: 1; text-shadow: 0 0 12px rgba(0, 255, 153, 1); }
        }
        
        /* Estilos do Slider DPI (mais detalhado) */
        #dpi-slider { 
            -webkit-appearance: none; appearance: none; width: 100%; height: 12px; /* Mais espesso */
            border-radius: 6px; outline: none; transition: background 0.3s ease-in-out; 
            background: var(--bg-inactive); 
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.6);
        }
        #dpi-slider::-webkit-slider-thumb { 
            -webkit-appearance: none; appearance: none; width: 30px; height: 30px; /* Maior */
            border-radius: 50%; background: linear-gradient(45deg, var(--neon-secondary), #00ffff); cursor: grab; 
            box-shadow: var(--accent-glow-cyan), 0 0 15px var(--neon-primary); /* Brilho duplo */
            border: 4px solid var(--bg-dark); /* Borda do polegar mais grossa */
            transition: all 0.2s ease-in-out;
        }
        #dpi-slider::-webkit-slider-thumb:active { /* Efeito ao arrastar */
            cursor: grabbing;
            transform: scale(1.1);
            box-shadow: 0 0 25px var(--neon-secondary), 0 0 40px var(--neon-secondary);
        }

        /* Estilo do Bot√£o Principal ATIVAR (mais impactante) */
        .activate-button {
            background: linear-gradient(90deg, #ff00ff 0%, var(--neon-primary) 100%);
            color: white;
            padding: 1.2rem 3.5rem; /* Maior */
            font-size: 1.8rem; /* Maior */
            font-weight: 900; /* Mais bold */
            border-radius: 20px; /* Mais arredondado */
            border: 4px solid var(--neon-secondary); /* Borda mais grossa */
            box-shadow: 0 0 25px #ff00ff, 0 0 50px var(--neon-primary);
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1.2); /* Anima√ß√£o el√°stica */
            text-shadow: 0 0 8px black, 0 0 15px var(--neon-primary);
            letter-spacing: 2px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
            font-family: 'Orbitron', sans-serif;
        }
        .activate-button:hover {
            background: linear-gradient(90deg, var(--neon-secondary) 0%, #00eaff 100%);
            color: var(--bg-dark);
            border-color: var(--neon-primary);
            box-shadow: 0 0 40px var(--neon-secondary), 0 0 80px var(--neon-secondary);
            transform: scale(1.05); /* Escala mais agressiva */
            text-shadow: 0 0 5px var(--neon-primary);
        }
        .activate-button::after { /* Efeito de brilho "swipe" */
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transform: skewX(-20deg);
            transition: all 0.7s ease;
        }
        .activate-button:hover::after {
            left: 100%;
        }

        /* Estilo da √°rea de Key (roda-p√©) */
        .key-info-footer {
            background-color: rgba(30, 30, 50, 0.85); /* Mais opaco */
            padding: 1rem; /* Mais preenchimento */
            border-radius: 12px; /* Mais arredondado */
            font-family: 'Share Tech Mono', monospace;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: 2px dashed rgba(0, 234, 255, 0.3); /* Borda superior estilizada */
            margin-top: 3rem;
        }
        
        .key-text {
            color: var(--neon-secondary);
            font-size: 1.1rem;
            letter-spacing: 1.5px;
            flex-grow: 1; /* Permite que o texto ocupe mais espa√ßo */
            overflow: hidden;
            text-overflow: ellipsis; /* Corta o texto se for muito longo */
            white-space: nowrap;
        }
        .key-text .text-neon-primary { /* Estilo da data de expira√ß√£o */
            font-weight: bold;
            text-shadow: 0 0 8px var(--neon-primary);
        }

        .copy-key-icon {
            color: white;
            background: var(--neon-primary);
            padding: 0.7rem 1.2rem; /* Maior */
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1.2);
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 0 10px var(--neon-primary);
            margin-left: 1rem;
        }
        .copy-key-icon:hover {
            background: var(--neon-secondary);
            color: var(--bg-dark);
            box-shadow: 0 0 20px var(--neon-secondary);
            transform: scale(1.05);
        }

        /* ========================================================= */
        /* ESTILOS DE LOGIN E MODAIS (APRIMORADOS) */
        /* ========================================================= */
        .login-screen-container { 
            height: 100vh; display: flex; justify-content: center; align-items: center; text-align: center; 
        }
        @keyframes login-fade-in {
            from { opacity: 0; transform: translateY(50px) scale(0.95); filter: blur(5px); }
            to { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
        }
        .login-box {
            width: 90%; max-width: 500px; /* Mais largo */
            padding: 4rem; /* Mais preenchimento */
            border: 3px solid rgba(0, 234, 255, 0.7); /* Borda mais grossa */
            background: rgba(10, 5, 20, 0.9); /* Mais opaco */
            backdrop-filter: blur(25px) saturate(180%); 
            box-shadow: 0 4px 50px rgba(0, 0, 0, 0.6), 0 0 80px rgba(161, 0, 255, 0.5); /* Sombras mais intensas */
            border-radius: 25px; /* Mais arredondado */
            animation: login-fade-in 1s ease-out forwards; 
            position: relative;
            overflow: hidden; /* Para o pseudo-elemento da borda */
        }
        .login-box::before { /* Brilho da borda animado no login */
            content: '';
            position: absolute;
            top: -5px; bottom: -5px; left: -5px; right: -5px;
            border-radius: 30px;
            background: linear-gradient(45deg, var(--neon-primary), var(--neon-secondary), var(--neon-primary));
            background-size: 400% 400%;
            z-index: -1;
            opacity: 0.7;
            filter: blur(10px);
            animation: border-glow-animate 7s infinite alternate;
        }
        .login-box::after { /* Elemento de "status" no canto */
            content: 'SYSTEM ONLINE _';
            position: absolute; bottom: 15px; right: 20px; font-family: 'Share Tech Mono', monospace; 
            font-size: 0.9rem; color: #00ff99; text-shadow: 0 0 5px #00ff99; opacity: 0.8;
            animation: blink-cursor 0.7s infinite;
        }

        @keyframes blink-cursor {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0; }
        }

        .login-box .neon-glow {
            font-family: 'Orbitron', sans-serif;
            text-shadow: var(--accent-glow-purple);
        }

        #key-input {
            width: 100%; padding: 1.5rem; background-color: rgba(0, 0, 0, 0.5); /* Mais escuro */
            border: 3px solid var(--neon-primary); border-bottom: 5px solid var(--neon-secondary); /* Bordas mais grossas */
            color: var(--neon-secondary); font-size: 1.6rem; text-align: center; border-radius: 10px; 
            margin-bottom: 2.5rem; box-shadow: 0 0 15px rgba(161, 0, 255, 0.3); outline: none;
            letter-spacing: 4px; transition: all 0.4s ease; font-family: 'Share Tech Mono', monospace; text-transform: uppercase;
        }
        #key-input:focus { 
            border-color: var(--neon-secondary); background-color: rgba(0, 234, 255, 0.15); 
            box-shadow: 0 0 40px var(--neon-secondary), 0 0 15px var(--neon-primary); 
        }
        .key-submit-button {
            font-weight: 900; padding: 1.2rem 2rem; border-radius: 10px; transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1.2); border: none;
            width: 100%; text-transform: uppercase; letter-spacing: 2px;
            background: linear-gradient(90deg, var(--neon-secondary) 0%, #00ffff 100%); /* Gradiente vibrante */
            color: var(--bg-dark); box-shadow: 0 0 20px var(--neon-secondary);
            font-size: 1.6rem;
            font-family: 'Orbitron', sans-serif;
        }
        .key-submit-button:hover:not(:disabled) { 
            box-shadow: 0 0 50px var(--neon-secondary), 0 0 20px var(--neon-primary); 
            transform: scale(1.02); 
            filter: brightness(1.2);
        }
        .key-submit-button:disabled {
            background: #3f3b55; cursor: not-allowed; box-shadow: none; color: #a0a0a0;
            filter: grayscale(80%);
            transform: none;
        }
        .error-message { 
            color: #ff5588; text-shadow: 0 0 10px rgba(255, 85, 136, 1); margin-top: 2rem; 
            font-size: 1.1rem; font-weight: 700; border-top: 2px dashed #ff5588; padding-top: 1.5rem;
            font-family: 'Share Tech Mono', monospace;
            animation: error-pulse 1s infinite alternate;
        }
        @keyframes error-pulse {
            0% { opacity: 0.9; text-shadow: 0 0 5px rgba(255, 85, 136, 0.5); }
            100% { opacity: 1; text-shadow: 0 0 15px rgba(255, 85, 136, 1); }
        }

        .modal-key-dialog {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.95); z-index: 1000; /* Z-index mais alto */
            display: flex; justify-content: center; align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-key-dialog.active { /* Nova classe para controlar visibilidade */
            opacity: 1;
            visibility: visible;
        }
        .modal-key-content {
            background: var(--bg-card); backdrop-filter: blur(20px) saturate(150%);
            padding: 3.5rem; border-radius: 20px;
            border: 3px solid var(--neon-secondary); box-shadow: 0 0 80px var(--neon-secondary)/60;
            width: 90%; max-width: 600px; text-align: center;
            transform: translateY(20px) scale(0.98);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .modal-key-dialog.active .modal-key-content {
            transform: translateY(0) scale(1);
        }
        .key-display-container {
            display: flex; align-items: center; justify-content: space-between;
            background-color: var(--bg-inactive); border: 2px solid var(--neon-secondary);
            border-radius: 10px; margin: 1.8rem 0; padding: 1rem; 
            box-shadow: inset 0 0 10px rgba(0, 234, 255, 0.2);
        }
        .key-display {
            color: var(--neon-secondary); font-size: 1.6rem; padding: 0.5rem; 
            font-family: 'Share Tech Mono', monospace; letter-spacing: 2px; word-break: break-all;
            flex-grow: 1; text-align: left; padding-left: 1rem;
        }
        .copy-button {
            background: var(--neon-primary); color: white; padding: 1rem 1.5rem; 
            border-radius: 8px; margin-left: 15px; transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
            text-transform: uppercase; font-weight: 700;
            box-shadow: 0 0 15px var(--neon-primary);
        }
        .copy-button:hover {
            background: var(--neon-secondary); color: var(--bg-dark); transform: scale(1.08);
            box-shadow: 0 0 25px var(--neon-secondary);
        }
        .key-generate-button {
            background: transparent; color: var(--neon-primary); border: 2px solid var(--neon-primary); 
            font-size: 1.1rem; padding: 1rem 1.8rem; border-radius: 10px; transition: all 0.3s ease;
            text-transform: uppercase;
            font-weight: bold;
        }
        .key-generate-button:hover { 
            box-shadow: 0 0 25px var(--neon-primary); background: rgba(161, 0, 255, 0.25); 
            transform: scale(1.02);
        }
        
        #main-hud-panel { display: none; } /* Escondido por padr√£o */
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        orbitron: ['Orbitron', 'sans-serif'],
                        sharetech: ['Share Tech Mono', 'monospace'],
                    },
                    colors: {
                        'neon-primary': 'var(--neon-primary)',
                        'neon-secondary': 'var(--neon-secondary)',
                    }
                }
            }
        }
    </script>
</head>
<body class="futuristic-theme" id="main-body">
    
    <div id="video-background">
        <iframe 
            src="https://www.youtube.com/embed/1eX7l3V9xRw?autoplay=1&mute=1&loop=1&playlist=1eX7l3V9xRw&controls=0&modestbranding=1&rel=0&showinfo=0&iv_load_policy=3&start=20"
            frameborder="0"
            allow="autoplay; encrypted-media; loop"
            allowfullscreen>
        </iframe>
    </div>
    <div class="matrix-overlay"></div>

    <div id="login-screen" class="login-screen-container">
        <div class="login-box">
            <h1 class="text-5xl md:text-6xl font-black tracking-tighter uppercase neon-glow text-neon-primary mb-3 glitch-text">
                ASSISTENTE <span class="text-neon-secondary">FF</span>
            </h1>
            <h2 class="text-xl text-gray-300 mb-10 font-light border-b-2 border-neon-secondary/40 pb-4 font-sharetech">
                <span class="text-neon-secondary font-bold">M√ìDULO DE AUTENTICA√á√ÉO HFR-42</span>
            </h2>

            <form id="login-form" onsubmit="handleLogin(event)">
                <label for="key-input" class="block text-left text-sm font-semibold text-gray-200 mb-3 font-sharetech">
                    üîë CHAVE DE ACESSO EXCLUSIVA:
                </label>
                <input type="text" id="key-input" placeholder="XXXXXX-YYYYYY-ZZZZZZ" required maxlength="20">
                
                <button type="submit" class="key-submit-button text-2xl">
                    <span id="login-text">CONECTAR AO SISTEMA</span>
                </button>
            </form>
            
            <p id="login-error-message" class="error-message"></p>
        </div>
    </div>
    <div id="key-modal" class="modal-key-dialog hidden">
        <div class="modal-key-content">
            <h3 class="text-3xl font-bold text-neon-primary mb-4">üîë STATUS DA CHAVE DE ACESSO</h3>
            
            <p class="text-gray-300 mb-4" id="key-modal-info">Verificando expira√ß√£o...</p>
            
            <div class="key-display-container">
                <span id="current-valid-key" class="key-display">CHAVE N√ÉO ENCONTRADA</span>
                <button onclick="copyKeyToClipboard()" class="copy-button" id="copy-btn">
                    <span id="copy-text">üìã COPIAR</span>
                </button>
            </div>

            <p class="text-sm text-yellow-400 mt-2">AVISO: Esta chave est√° vinculada a este dispositivo/navegador at√© a data de expira√ß√£o.</p>
            <button onclick="document.getElementById('key-modal').classList.add('hidden')" class="key-submit-button mt-4 text-lg">
                FECHAR
            </button>
        </div>
    </div>

    <div id="admin-modal" class="modal-key-dialog hidden">
        <div class="modal-key-content">
            <h3 class="text-3xl font-bold text-red-500 mb-4">üëë PAINEL DE GEST√ÉO DE CHAVES</h3>
            <p class="text-yellow-400 mb-4">ACESSO CONCEDIDO: Admin Master Key ATIVA.</p>
            
            <div class="space-y-4 text-left">
                <label class="block text-gray-200 font-bold">1. SELECIONE A DURA√á√ÉO DA NOVA KEY (Para o cliente):</label>
                <select id="key-duration-select" class="w-full p-3 bg-gray-900/50 border border-red-500/50 rounded-lg text-neon-secondary text-lg">
                    <option value="7">7 Dias (Padr√£o)</option>
                    <option value="15">15 Dias</option>
                    <option value="30">30 Dias</option>
                </select>
                
                <button onclick="adminGenerateNewKey()" class="key-submit-button bg-red-600 hover:bg-red-700 text-2xl mt-4">
                    ‚ö†Ô∏è GERAR NOVA KEY COM DURA√á√ÉO
                </button>
                <p id="admin-message" class="error-message text-center mt-2"></p>
                <p class="text-xs text-gray-500 text-center">A nova chave ser√° automaticamente copiada para sua √°rea de transfer√™ncia.</p>
            </div>

            <button onclick="document.getElementById('admin-modal').classList.add('hidden'); handleAdminLogout();" class="key-generate-button mt-6 text-lg bg-red-800 hover:bg-red-900 border-none !text-white !p-3">
                SAIR DO MODO ADMIN
            </button>
        </div>
    </div>

    <div id="main-hud-panel" class="main-panel-container">
        <div class="hud-frame">
            <header class="text-center mb-10">
                <h1 class="text-5xl font-black uppercase neon-title text-neon-primary">
                    ASSISTENTE <span class="text-neon-secondary">FF</span>
                </h1>
                <h2 class="text-xl font-light text-gray-300 mt-2">
                    M√ìDULO DE OTIMIZA√á√ÉO E ASSIST√äNCIA V4.0
                </h2>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <div>
                    <h3 class="text-2xl font-bold text-neon-secondary mb-4 border-b border-neon-secondary/50 pb-2">FUN√á√ïES EXCLUSIVAS</h3>

                    <div class="module-box flex items-center justify-between mb-4">
                        <label for="toggle-optimization-input" class="text-xl font-medium text-gray-100">Otimiza√ß√£o de Ping</label>
                        <input type="checkbox" id="toggle-optimization-input" class="sr-only" onchange="toggleFeature('Optimization')"> 
                        <div id="toggle-optimization" class="modern-switch" role="switch" onclick="document.getElementById('toggle-optimization-input').click()"></div>
                    </div>

                    <div class="module-box flex items-center justify-between mb-4">
                        <label for="toggle-precision-input" class="text-xl font-medium text-gray-100">Anti-Recoil Avan√ßado</label>
                        <input type="checkbox" id="toggle-precision-input" class="sr-only" onchange="toggleFeature('Precision')"> 
                        <div id="toggle-precision" class="modern-switch" role="switch" onclick="document.getElementById('toggle-precision-input').click()"></div>
                    </div>

                    <div class="module-box flex items-center justify-between mb-8">
                        <label for="toggle-aimguide-input" class="text-xl font-medium text-gray-100">Assist√™ncia de Mira (AimGuide)</label>
                        <input type="checkbox" id="toggle-aimguide-input" class="sr-only" onchange="toggleFeature('AimGuide')"> 
                        <div id="toggle-aimguide" class="modern-switch" role="switch" onclick="document.getElementById('toggle-aimguide-input').click()"></div>
                    </div>
                    
                    <h3 class="text-xl font-bold text-neon-primary mb-3">SELE√á√ÉO DE DPI: <span id="dpi-value" class="text-neon-secondary">50%</span></h3>
                    <input type="range" id="dpi-slider" min="0" max="100" value="50" oninput="updateDPI(this.value)" class="w-full">
                </div>

                <div class="space-y-6">
                    
                    <div class="module-box border-l-4 border-neon-secondary">
                        <h4 class="text-lg font-bold text-neon-secondary mb-3">DIAGN√ìSTICO EM TEMPO REAL</h4>
                        <p class="text-xl font-medium text-gray-100 mb-2">STATUS CONEX√ÉO</p>
                        <div class="flex items-center justify-between">
                            <svg class="w-1/3 h-12" viewBox="0 0 100 50" preserveAspectRatio="none" style="filter: drop-shadow(0 0 5px rgba(0, 234, 255, 0.5));">
                                <polyline id="ping-graph" fill="none" stroke="var(--neon-secondary)" stroke-width="2" points="0,40 10,25 20,35 30,15 40,30 50,20 60,35 70,10 80,30 90,20 100,40"/>
                            </svg>
                            <p class="ping-display"><span id="ping-counter">15</span><span class="text-xl ml-1">MS</span></p>
                        </div>
                    </div>
                    
                    <div class="module-box border-l-4 border-neon-primary">
                        <h4 class="text-lg font-bold text-neon-primary mb-3">DETEC√á√ÉO DE ERROS (V.O.L.S)</h4>
                        <div id="vols-status" class="text-sm stable-status-text min-h-[5rem] text-gray-300 font-mono">
                            VARREDURA COMPLETA. 0 ERROS ENCUDANDO. 
                            <br><span class="status-secure">SYSTEM STATUS: SECURE.</span>
                        </div>
                    </div>

                </div>
            </div>
            
            <div class="text-center my-10">
                <button onclick="activateModsAndLaunch()" class="activate-button uppercase">
                    ATIVAR MODS E INICIAR JOGO
                </button>
            </div>
            
            <div class="key-info-footer">
                <span id="key-display-text" class="key-text">KEY: [AUTENTICANDO...]</span>
                <button onclick="displayCurrentKey()" class="copy-key-icon">
                    <span id="copy-text-footer">VER EXPIRA√á√ÉO</span>
                </button>
            </div>
            
        </div>
    </div>

    <script>
        
        // =========================================================
        // DEFINI√á√ïES DE SEGURAN√áA E ADMIN
        // =========================================================
        const KEY_STORAGE_ID = 'validAccessKey'; 
        const STATE_STORAGE_ID = 'ffAssistantAppState'; 
        const ADMIN_MASTER_KEY = 'ADM-123456-BOSS'; // <-- CHAVE MESTRA!
        // =========================================================

        const loginScreen = document.getElementById('login-screen');
        const mainPanel = document.getElementById('main-hud-panel');
        const loginErrorMsg = document.getElementById('login-error-message');
        const loginButtonText = document.getElementById('login-text');
        const keyInput = document.getElementById('key-input');
        const slider = document.getElementById('dpi-slider');
        const valueDisplay = document.getElementById('dpi-value');
        
        let appState = {
            Optimization: false, AimGuide: false, Precision: false, AimPrecisionPercentage: 50,
        };

        // --- FUN√á√ïES DE GERA√á√ÉO E VALIDA√á√ÉO DE KEY COM EXPIRA√á√ÉO ---

        function generateRandomSixDigits() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        function generateNewAccessKey(durationDays = 7) { 
            const part1 = generateRandomSixDigits();
            const part2 = generateRandomSixDigits();
            const part3 = generateRandomSixDigits();
            const newKeyString = `${part1}-${part2}-${part3}`;
            
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + durationDays);
            
            const keyData = {
                key: newKeyString,
                expiry: expiryDate.getTime(),
                durationDays: durationDays
            };
            
            localStorage.setItem(KEY_STORAGE_ID, JSON.stringify(keyData)); 
            return newKeyString;
        }
        
        function isKeyFormatValid(key) {
            const keyRegex = /^(\d{6})-(\d{6})-(\d{6})$/;
            return keyRegex.test(key);
        }
        
        async function handleLogin(event) {
            event.preventDefault(); 
            
            const enteredKey = keyInput.value.trim().toUpperCase();

            loginErrorMsg.textContent = '';
            loginButtonText.textContent = 'AUTENTICANDO...';
            loginButtonText.parentElement.disabled = true;

            await new Promise(resolve => setTimeout(resolve, 1500));
            
            if (enteredKey === ADMIN_MASTER_KEY) {
                keyInput.value = '';
                showAdminPanel();
                return;
            }

            const storedKeyJSON = localStorage.getItem(KEY_STORAGE_ID);
            let keyMatches = false;
            let isExpired = true;

            if (storedKeyJSON) {
                try {
                    const storedKeyData = JSON.parse(storedKeyJSON);
                    
                    if (enteredKey === storedKeyData.key) {
                        keyMatches = true;
                        if (Date.now() < storedKeyData.expiry) {
                            isExpired = false;
                        }
                    }
                } catch (e) {
                    localStorage.removeItem(KEY_STORAGE_ID);
                }
            }
            
            // L√≥gica Central: Se a chave digitada for a MESTRE (para o cliente), armazena ela e loga.
            // Nota: No nosso sistema front-end, a "chave mestra" para o cliente √© a √∫ltima chave gerada pelo Admin.
            // Para simular a entrega de uma nova key, trataremos qualquer key 6-6-6 como "nova" se n√£o houver uma v√°lida.
            if (!keyMatches && isKeyFormatValid(enteredKey)) {
                 // Assumindo que o Admin entregou essa chave, a armazenamos localmente.
                 generateNewAccessKey(7); // default 7 dias, mas idealmente teria uma dura√ß√£o vinculada.
                 const keyData = JSON.parse(localStorage.getItem(KEY_STORAGE_ID));
                 keyData.key = enteredKey;
                 // Definir uma expira√ß√£o padr√£o para a nova chave (ex: 7 dias a partir de agora)
                 const newExpiryDate = new Date();
                 newExpiryDate.setDate(newExpiryDate.getDate() + 7);
                 keyData.expiry = newExpiryDate.getTime();
                 keyData.durationDays = 7; 
                 localStorage.setItem(KEY_STORAGE_ID, JSON.stringify(keyData));
                 
                 completeLogin();
                 return;
            }

            if (keyMatches && !isExpired) {
                completeLogin();
                return;
            }

            if (keyMatches && isExpired) {
                loginErrorMsg.textContent = 'ERRO [COD 408]: Sua Key EXPIROU. Solicite uma nova chave.';
                localStorage.removeItem(KEY_STORAGE_ID); 
            } else {
                loginErrorMsg.textContent = 'ERRO [COD 403]: Chave inv√°lida, expirada ou n√£o reconhecida. Tente novamente.';
            }

            loginButtonText.textContent = 'CONECTAR AO SISTEMA';
            loginButtonText.parentElement.disabled = false;
            keyInput.value = '';
        }

        function completeLogin() {
            loginScreen.style.display = 'none';
            mainPanel.style.display = 'flex';
            document.getElementById('main-body').classList.remove('login-screen-container');
            
            loadAppState(); 
            initializeApp();
            updateKeyInfoInFooter(); // Atualiza o rodap√© com a Key
        }

        function copyKeyToClipboard() {
            const keyElement = document.getElementById('current-valid-key');
            const key = keyElement.textContent;
            const copyBtn = document.getElementById('copy-text');

            if (key && key !== 'CHAVE N√ÉO ENCONTRADA') {
                navigator.clipboard.writeText(key).then(() => {
                    copyBtn.textContent = '‚úÖ COPIADO!';
                    setTimeout(() => { copyBtn.textContent = 'üìã COPIAR'; }, 2000);
                }).catch(err => {
                    alert("Erro ao copiar.");
                });
            }
        }
        
        function updateKeyInfoInFooter() {
            const storedKeyJSON = localStorage.getItem(KEY_STORAGE_ID);
            const keyFooter = document.getElementById('key-display-text');
            const keyData = storedKeyJSON ? JSON.parse(storedKeyJSON) : null;

            if (keyData && keyData.key) {
                const expiryDate = new Date(keyData.expiry);
                const formattedDate = expiryDate.toLocaleDateString('pt-BR');
                
                keyFooter.innerHTML = `KEY: ${keyData.key} (EXP: <span class="text-neon-primary">${formattedDate}</span>)`;
            } else {
                keyFooter.textContent = 'KEY: [N/A] (FA√áA LOGIN)';
            }
        }

        function displayCurrentKey() {
            const storedKeyJSON = localStorage.getItem(KEY_STORAGE_ID);
            const keyDisplayElement = document.getElementById('current-valid-key');
            const keyModalInfo = document.getElementById('key-modal-info');
            
            if (storedKeyJSON) {
                try {
                    const keyData = JSON.parse(storedKeyJSON);
                    const expiryDate = new Date(keyData.expiry);
                    keyDisplayElement.textContent = keyData.key;
                    
                    const formattedDate = expiryDate.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
                    
                    if (Date.now() >= keyData.expiry) {
                         keyModalInfo.innerHTML = `STATUS: <span class="text-red-500 font-bold">EXPIRADA!</span>`;
                    } else {
                         keyModalInfo.innerHTML = `DURA√á√ÉO: ${keyData.durationDays} dias | V√°lida at√©: <span class="text-neon-secondary font-bold">${formattedDate}</span>`;
                    }
                } catch (e) {
                     keyDisplayElement.textContent = 'Erro ao processar Key.';
                     keyModalInfo.textContent = '';
                }
            } else {
                keyDisplayElement.textContent = 'CHAVE N√ÉO ENCONTRADA';
                keyModalInfo.innerHTML = '<span class="text-red-500 font-bold">Status: N√£o logado.</span>';
            }
            document.getElementById('key-modal').classList.remove('hidden');
        }
        
        // --- FUN√á√ïES DE ADMIN ---
        function showAdminPanel() {
            loginScreen.style.display = 'none'; 
            mainPanel.style.display = 'none';   
            document.getElementById('admin-modal').classList.remove('hidden'); 
            document.getElementById('admin-message').textContent = '';
        }
        
        function handleAdminLogout() {
            document.getElementById('admin-modal').classList.add('hidden'); 
            document.getElementById('login-screen').style.display = 'flex';
        }

        function adminGenerateNewKey() {
            const select = document.getElementById('key-duration-select');
            const durationDays = parseInt(select.value);
            
            const newKey = generateNewAccessKey(durationDays); 
            
            const adminMsg = document.getElementById('admin-message');
            adminMsg.textContent = `‚úÖ NOVA KEY GERADA: ${newKey} (Dura√ß√£o: ${durationDays} dias). COPIADA!`;
            adminMsg.style.color = '#00eaff'; 
            adminMsg.style.textShadow = '0 0 5px rgba(0, 234, 255, 0.8)';
            
            navigator.clipboard.writeText(newKey);
        }
        // --- FIM FUN√á√ïES DE ADMIN ---

        // --- FUN√á√ïES DE PERSIST√äNCIA E SIMULA√á√ÉO ---

        function saveAppState() {
            appState.AimPrecisionPercentage = parseInt(document.getElementById('dpi-slider').value);
            try {
                localStorage.setItem(STATE_STORAGE_ID, JSON.stringify(appState));
            } catch (e) { console.error("Erro ao salvar estado", e); }
        }

        function loadAppState() {
            try {
                const storedState = localStorage.getItem(STATE_STORAGE_ID);
                if (storedState) {
                    const loadedState = JSON.parse(storedState);
                    appState = { ...appState, ...loadedState };

                    const slider = document.getElementById('dpi-slider');
                    if (slider) {
                        slider.value = appState.AimPrecisionPercentage || 50;
                        updateDPI(slider.value, true); 
                    }
                    
                    ['Optimization', 'AimGuide', 'Precision'].forEach(feature => {
                        const inputId = `toggle-${feature.toLowerCase()}-input`;
                        const inputElement = document.getElementById(inputId);
                        
                        if (inputElement) {
                            const shouldBeActive = appState[feature];
                            if (inputElement.checked !== shouldBeActive) {
                                inputElement.checked = shouldBeActive;
                                toggleFeature(feature, true);
                            }
                        }
                    });
                }
            } catch (e) { console.error("Erro ao carregar estado", e); }
        }

        function updateDPI(value, isLoad = false) {
            appState.AimPrecisionPercentage = parseInt(value);
            valueDisplay.textContent = `${appState.AimPrecisionPercentage}%`;
            
            const percentage = value + '%';
            slider.style.background = `linear-gradient(to right, var(--neon-secondary) ${percentage}, var(--bg-inactive) ${percentage})`;

            if (!isLoad) { saveAppState(); }
        }

        function toggleFeature(feature, isLoad = false) {
            const inputId = `toggle-${feature.toLowerCase()}-input`;
            const inputElement = document.getElementById(inputId);
            const toggleId = `toggle-${feature.toLowerCase()}`;
            const toggleElement = document.getElementById(toggleId);
            
            const willBeActive = inputElement.checked; 
            appState[feature] = willBeActive;

            if (!isLoad) { saveAppState(); }

            if (toggleElement) {
                toggleElement.classList.toggle('active', willBeActive);
            }
            
            // Simula√ß√£o de Status V.O.L.S
            const statusElement = document.getElementById('vols-status');
            const activeCount = Object.values(appState).filter(val => val === true).length;
            
            if (activeCount > 0) {
                statusElement.innerHTML = `MODOS ATIVOS: ${activeCount}. DIAGN√ìSTICO EM CURSO. 
                <br><span class="text-yellow-400">STATUS: CUIDADO AO INICIAR.</span>`;
            } else {
                statusElement.innerHTML = `VARREDURA COMPLETA. 0 ERROS ENCUDANDO. 
                <br><span class="status-secure">SYSTEM STATUS: SECURE.</span>`;
            }
        }
        
        let pingInterval;

        function startPingSim() {
            const pingCounter = document.getElementById('ping-counter');
            const pingGraph = document.getElementById('ping-graph');
            let history = Array(11).fill(40); // 11 pontos, valor inicial 40 (para 50 de altura)

            clearInterval(pingInterval);

            pingInterval = setInterval(() => {
                const currentPing = Math.floor(Math.random() * (40 - 10) + 10);
                pingCounter.textContent = currentPing;
                
                // Atualiza o hist√≥rico (normaliza o ping para a altura do gr√°fico 0-50)
                // 10ms -> 45 (topo), 40ms -> 5 (base)
                const normalizedHeight = 50 - ((currentPing - 10) / 30) * 40; 
                
                history.shift();
                history.push(normalizedHeight);
                
                const points = history.map((h, i) => `${i * 10},${h}`).join(' ');
                pingGraph.setAttribute('points', points);

            }, 800);
        }

        function activateModsAndLaunch() {
            // L√≥gica de ativa√ß√£o e lan√ßamento
            const activeCount = Object.values(appState).filter(val => val === true).length;
            if (activeCount > 0) {
                alert(`ATIVANDO: ${activeCount} MODS. INICIANDO FREE FIRE OTIMIZADO...`);
            } else {
                alert("Nenhuma fun√ß√£o ativada. Iniciando Free Fire normalmente...");
            }
            
            // Simula o lan√ßamento do aplicativo (Deep Link)
            const deepLinkUri = "garenafreefire://";
            window.location.href = deepLinkUri;
        }


        function initializeApp() {
            if (slider && valueDisplay) { updateDPI(appState.AimPrecisionPercentage, true); }
            startPingSim(); // Inicia o simulador de ping no fundo
        }

        // Chama a fun√ß√£o de verifica√ß√£o de login ao carregar
        document.addEventListener('DOMContentLoaded', checkLoginStatus);
        
        // Fun√ß√£o para checar o login (mantida da v3.0)
        function checkLoginStatus() {
            const storedKeyJSON = localStorage.getItem(KEY_STORAGE_ID);
            
            if (storedKeyJSON) {
                try {
                    const storedKeyData = JSON.parse(storedKeyJSON);
                    
                    if (Date.now() < storedKeyData.expiry) {
                        completeLogin(); // Loga automaticamente
                        return;
                    } else {
                        localStorage.removeItem(KEY_STORAGE_ID); // Expira
                    }
                } catch (e) {
                    localStorage.removeItem(KEY_STORAGE_ID);
                }
            }
            
            keyInput.value = ''; 
            loginScreen.style.display = 'flex';
            mainPanel.style.display = 'none';
            document.getElementById('main-body').classList.add('login-screen-container');

            loadAppState(); 
            initializeApp();
        }

    </script>
</body>
</html>
